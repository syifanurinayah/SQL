select x.*
from employee e
join (select *, 
      max(salary) over(partition by dept_name) as max_salary,
      min(salary) over(partition by dept_name) as min_salary
      from employee e) x
      on e.emp_id = x.emp_id
      and (e.salary = x.max_salary or e.salary = x.min_salary)
order by x.dept_name, x.salary;
      